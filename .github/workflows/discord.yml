name: Discord Embed Notify

on:
  push:
    branches:
      - main
      - master

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      # Checkout is nodig zodat commits beschikbaar zijn
      - name: Checkout repository
        uses: actions/checkout@v4

      # Verstuur commits naar Discord
      - name: Discord Commits
        uses: Sniddl/discord-commits@v1.6
        with:
          webhook: ${{ secrets.DISCORD_WEBHOOK }}
          message: "Successful commit to **{{ github.context.payload.repository.owner.name }}/{{ github.context.payload.repository.name }}**.\nDiff: {{ github.context.payload.compare }}"
          embed: >
            {
              "title": "{{ commit.title }}",
              "description": "{{ commit.description }}",
              "url": "{{ commit.url }}",
              "footer": {
                "text": "{{ commit.author.name }}",
                "icon_url": "https://github.com/{{ commit.author.username }}.png"
              }
            }
          last-commit-only: true
