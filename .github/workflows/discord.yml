name: Discord Embed Notify

on:
  push:
    branches:
      - main
      - master

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Verstuur naar Discord
        run: |
          # Pak de commit message
          COMMIT_MSG="${{ github.event.head_commit.message }}"
          # Eerste regel = title
          TITLE=$(echo "$COMMIT_MSG" | head -n1)
          # Rest = description (alles behalve eerste regel)
          DESCRIPTION=$(echo "$COMMIT_MSG" | tail -n +2)

          # Stuur naar Discord
          curl -H "Content-Type: application/json" \
               -X POST \
               -d "{
                 \"embeds\": [{
                   \"title\": \"$TITLE\",
                   \"description\": \"$DESCRIPTION\",
                   \"color\": 16753920,
                   \"footer\": {
                     \"text\": \"Auteur: ${{ github.event.head_commit.author.name }}\",
                     \"icon_url\": \"https://github.com/${{ github.event.head_commit.author.username }}.png\"
                   }
                 }]
               }" \
               ${{ secrets.DISCORD_WEBHOOK }}
